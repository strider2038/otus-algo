# Проектная работа

## План

* [x] базовый паттерн
* [x] все паттерны
* [x] выделение значений и типов
* [x] причесать
* [x] бенчмарк
* [ ] исследование вариантов
    * [x] v1 базовая версия с последовательностью конечных автоматов
    * [x] v2 вариант оптимизации с предобработкой строки (нижний регистр, схлопывание пробелов)
    * [x] v3 группировка конечных автоматов
    * [x] v4 алгоритм на регулярках
    * [ ] исходный алгоритм на регулярках
* [ ] добавить реальных тестовых кейсов
* [ ] оптимизации
* [ ] составить презентацию

## Пробные версии

* [ ] оптимизации
    * [x] предобработка строки + пробел в конец строки
    * [x] вместо буферной строки - начало и конец отрезка текста (оптимизация памяти)
        * обязательно нужна предобработка строки, иначе в выделениях будут лишние пробелы
    * [x] ~~предрасчет длин слов для выделения памяти под строковый буфер~~
    * [ ] объединить автоматы слов и шифров
    * [ ] индексированный массив вместо дерева (теоретически оптимизация по кешу процессора)
* [ ] доработки алгоритма
    * [ ] сборка автоматов из конфигурации (= компиляция регулярок?)
    * [ ] парсинг "тип 1 и 2"
    * [ ] выделение слов из шифров

## Тестирование эффективности алгоритмов

### Разбор полного образца

| Версия алгоритма | Время, ns/op | Память, B/op | Выделений памяти, allocs/op |
|------------------|-------------:|-------------:|----------------------------:|
| базовая          |        9 637 |        5 872 |                          92 |
| предобработка    |       11 592 |        5 488 |                          86 |
| оптимизированный |        8 529 |        3 376 |                          53 |
| оптимизированный |        7 736 |        2 904 |                          42 |
| regexp           |       16 421 |        2 446 |                          33 |
| исходный         |              |              |                             |

### Последовательный разбор всех тестовых образцов

| Версия алгоритма | Время, ns/op | Память, B/op | Выделений памяти, allocs/op |
|------------------|-------------:|-------------:|----------------------------:|
| базовая          |      116 660 |       41 832 |                         863 |
| предобработка    |      142 590 |       47 144 |                         957 |
| оптимизированный |      105 892 |       29 992 |                         689 |
| оптимизированный |       89 682 |       26 184 |                         635 |
| regexp           |      204 595 |       27 011 |                         693 |
| исходный         |              |              |                             |

### Последовательный разбор настоящих образцов

| Версия алгоритма | Время, ns/op | Память, B/op | Выделений памяти, allocs/op |
|------------------|-------------:|-------------:|----------------------------:|
| базовая          |   18 294 841 |    7 930 132 |                     130 430 |
| предобработка    |   18 011 552 |    7 917 277 |                     129 945 |
| оптимизированный |   12 941 340 |    4 866 192 |                      82 272 |
| оптимизированный |   11 485 934 |    4 138 298 |                      64 618 |
| regexp           |   23 079 911 |    3 308 944 |                      51 065 |
| исходный         |              |              |                             |
